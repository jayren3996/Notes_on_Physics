
\chapter{Interactions}

In this chapter, we are going to investigate the effects of interactions.
When the field theory is no longer free, the notion of free particle is not very well defined.
Also, the interactions actually gives the physical quantities that can be measured. 
For example the scattering amplitudes.

We will mainly focus on the scalar field theory, as the complexity of the vector or spinor field mainly comes from the algebraic structures of themselves.
After explaining the stories of the scalar filed, we will try to generalize them to the vector and spinor cases.


\section{Perturbation Theory}
\subsection{Real-space Formalism}
For interaction theory, the partition function can be formally expressed as:
\begin{equation}
	Z[J] = \exp\left(i\int d^dx \mathcal{L}_{\mathrm{int}}\left[\frac{\delta}{i\delta J(x)}\right]\right)Z_0[J].
\end{equation}
The expectation values for a generic operator of the form $O(\phi)$ can be evaluated by the true partition function
\begin{equation}\label{eq:ptb-exp-val}
	\langle O(\phi)\rangle
	= \frac{1}{Z[0]} \left. O\left[\frac{\delta}{i\delta J(x)}\right] Z[J] \right|_{J=0}.
\end{equation}

The expression (\ref{eq:ptb-exp-val}) can be expanded order by order using the Feynman diagram. 
Since the unconnected diagram can be absorbed into $Z[0]$, we only need to calculate the connected diagram.

The procedure of perturbative expansion with only connected diagrams can be formally represented by introducing the quantity
\begin{equation}
	Z[J] = Z[0]\exp\left(i W[J]\right).
\end{equation}
The perturbative expansion of $W[J]$ contain only the connected diagrams.
Note that for the free theory,
\begin{equation*}
	\frac{Z_0[J]}{Z_0[0]} = \exp\left[-\frac{i}{2}\int d^d x_1 d^d x_2 J(x_1) \Delta(x_1-x_2)J(x_2)\right],
\end{equation*}
which means
\begin{equation*}
	W_0 = -\frac{1}{2}\int d^d x_1 d^d x_2 J(x_1) \Delta(x_1-x_2)J(x_2).
\end{equation*}
For the interaction theory, the expectation (\ref{eq:ptb-exp-val}) can then be replaced by the connected expectation:
\begin{equation}
	\langle O(\phi)\rangle_c
	\equiv i\left. O\left[\frac{\delta}{i\delta J(x)}\right] W[J] \right|_{J=0}.
\end{equation}


Consider the two-point connected correlation (propagator):
\begin{equation}
\begin{aligned}
	i\Delta(x_1-x_2)
	&= \langle \mathcal{T}\phi(x_1) \phi(x_2)\rangle_c \\
	&= i\left.\frac{\delta^2 W[J]}{i\delta J(x_1) i\delta J(x_2)}\right|_{J=0} \\
	&= \left.\frac{\delta^2 \ln Z[J]}{i\delta J(x_1) i\delta J(x_2)}\right|_{J=0}\\
	&= \frac{1}{Z[0]}\left.\frac{\delta^2 Z[J]}{i\delta J(x_1)i\delta J(x_2)}\right|_{J=0},
\end{aligned}
\end{equation}
where we have used the fact that
\begin{equation}
	\frac{\delta Z^n[J]}{\delta J(x_1) \cdots \delta J(x_n)} = 0,\ \forall n = 1\ \mathrm{mod}\ 2.
\end{equation}
The result is the same as the original definition.

Further, we can consider the four-point connected correlation:
\begin{equation}
	iV_4 \equiv \langle \mathcal{T}\phi(x_1) \phi(x_2) \phi(x_3) \phi(x_4)\rangle_c
\end{equation}
Following the same procedure,
\begin{equation}
\begin{aligned}
	iV_4 
	=&\ i\left.\frac{\delta^4 W[J]}{i\delta J(x_1)i\delta J(x_2)i\delta J(x_3)i\delta J(x_4)}\right|_{J=0} \\
	=&\ \frac{1}{Z[0]}\left.\frac{\delta^4 Z[J]}{i\delta J(x_1)i\delta J(x_2)i\delta J(x_3)i\delta J(x_4)}\right|_{J=0} \\
	& -i\Delta(x_1-x_2) i\Delta(x_3-x_4) \\
	& -i\Delta(x_1-x_3) i\Delta(x_2-x_4) \\
	& -i\Delta(x_1-x_4) i\Delta(x_2-x_3).
\end{aligned}
\end{equation}
The connected correlation function automatically omit those disconnected components.


\subsection{Momentum-space Formalism}
In momentum space, the theory is expressed as
\begin{equation}
\begin{aligned}
	S_0[\phi(k)] &= \frac{1}{2} \int\frac{d^4 k}{(2\pi)^4}\ \phi_R^*(k)(k^2-m_R^2) \phi_R(k), \\
	S_\mathrm{int}[\phi(k)] &= \frac{g_R}{4!} \left(\prod_{i=1}^{4} \int \frac{d^4 k_i}{(2\pi)^4} \right) \left[\prod_{i=1}^4 \phi_R(k_i)\right] \delta^{(4)}\left(\sum_{i=1}^4 k_i\right), \\
	S_{\mathrm{ct}}[\phi(k)] &= \frac{1}{2} \int\frac{d^4 k}{(2\pi)^4}\ \tilde\phi_R^*(k)(A k^2 - B m_R^2) \tilde\phi_R(k) - C \cdot S_\mathrm{int}.
\end{aligned}
\end{equation}
For the free theory:
\begin{equation}
\begin{aligned}
	\frac{Z_0[J]}{Z_0[0]} &= \frac{1}{Z_0[0]}\int D[\phi] \exp\left\{ -S_0[\phi(k)] + i \int\frac{d^4 k}{(2\pi)^4} J_k^* \phi(k) \right\} \\
	&= \exp\left\{ -i \int\frac{d^4 k}{(2\pi)^4} J^*_k \Delta(k) J_k \right\}.
\end{aligned}
\end{equation}
Similarly, the expectation in momentum space is
\begin{equation}
	\langle O(\phi_k)\rangle
	= \frac{1}{Z[0]} \left. O\left[\frac{\delta}{i\delta J^*_k}\right] Z[J] \right|_{J=0}.
\end{equation}
The Feynman diagrams in momentum space is the same as that in real space, just replace the propagator from the real space to the momentum space.
Also, at each vertex, the momentum conservation is automatically satisfied.


\section{Renormalized Field Theory}

For the interacting scalar field, the Hamiltonian do not conserve particle number any more, and the ground state $|\Omega\rangle$ is no longer the vacuum $|0\rangle$.
Consider the Green's function
\begin{equation}
	iG(x_1-x_2) = \langle\Omega|T\phi(x_1)\phi(x_2)|\Omega\rangle 
\end{equation}
We can insert a complete basis into the correlation function:\footnote{Here we assume $\langle\Omega|\phi(x)|\Omega\rangle=0$ unless there is spontaneously symmetry breaking happening.}
\begin{equation}
	1 = |\Omega\rangle\langle\Omega| + \sum_\lambda\int\frac{d^3 k}{(2\pi)^3}\frac{1}{2\omega_k}|\lambda_{\bm k}\rangle \langle\lambda_{\bm k}|,
\end{equation}
and the Green's function takes the form:
\begin{equation*}
	iG(x_1-x_2) = \sum_\lambda \int\frac{d^3 k}{(2\pi)^3}
	\left[\theta(t_1-t_2)\langle\Omega|\phi(x_1)|\lambda_{\vec k}\rangle\langle\lambda_{\vec k}|\phi(x_2)|\Omega\rangle + (t_1\leftrightarrow t_2, x_1 \leftrightarrow x_2)\right].
\end{equation*}
Note that $\phi(x)=e^{iP\cdot x}\phi(0) e^{-iP\cdot x}$, so that
\begin{equation}
	\langle\lambda_{\bm k}|\phi(x)|\Omega\rangle 
	= e^{ik\cdot x} \left.\langle\lambda_{0}|\phi(0)|\Omega\rangle\right|_{k^0=\omega_{\bm k}}.
\end{equation}
Following the same procedure as we do for the free field theory, 
\begin{equation}
	G(x_1-x_2) = \int_0^\infty \frac{dM^2}{2\pi} \rho(M^2) G_0(x_1-x_2;M^2),
\end{equation}
where the \textit{spectral function} $\rho(M^2)$ is
\begin{equation}
	\rho(M^2) = \sum_\lambda(2\pi)\delta(M^2-m_\lambda^2)|\langle\Omega|\phi(0)|\lambda_0\rangle|^2.
\end{equation}
In particle, near the one-particle state the Green's function looks like:
\begin{equation}\label{eq:scalar-prop-lehmann}
	i\tilde G(k) = \frac{iZ_{\phi}}{k^2-m^2+i\epsilon} + \mathrm{regular\ terms}.
\end{equation}
Physically, Eq.~(\ref{eq:scalar-prop-lehmann}) states that in the interacting theory, the field operator $\tilde\phi(k)$ acting on the vacuum only only generate a single particle state, but also multi-particle states with total momentum $k$.
However, those multi-particle state have different singularity structure in the Greens function, as they only contribute regular terms.
If we only care about the propagator of the single particle states, we simply need to extract the singular part of of the Green's function.
That is, the singularity of $\tilde{G}(k)$ gives the (addresses) mass, and the residue 
\begin{equation*}
	\lim_{k^2 \rightarrow m^2} (k^2-m^2)\tilde{G}(k)
\end{equation*}
gives the wave-function normalization factor $Z_\phi$.
Trying to restore the original form of the free theory, we consider a renormalized field:
\begin{equation}
	\phi_R(x) = \frac{1}{\sqrt{Z_\phi}}\phi_0(x).
\end{equation}
The Green's function of $\phi_R$ has the same form as free theory.
For this reason, we generate the asymptotic single-particle state using the renormalized field operator:
\begin{equation}\label{eq:scalar-field-generate-particle}
	\phi_R(k)|\Omega\rangle = \frac{1}{2\omega_{\bm k}}|k\rangle + \text{multi-particle states}.
\end{equation}

If we want to create a single-particle state, say at time $t=0$.
We can do this by acting the operator $\tilde{\phi}(k)$ on the vacuum state at time $-T$, then we know when the system evolves for time $T$, it becomes:
\begin{equation}
	e^{-i E_{\bm k} T}|k\rangle + e^{-iHT} \cdot \text{multi-particle states}.
\end{equation}
Here comes the trick.
Assuming the theory is gapped (with mass $m^2>0$), the multi-particle states have higher energy than the single particle states.
We then replace the $t$ by $(1-i\epsilon)t$, which effectives impose a suppression factor $e^{-\epsilon H T}$ to the state.
In the $T\rightarrow \infty$ limit, the amplitude of the multi-particle states vanishes.

The story for the spinor field is exactly the same as the scalar field (also assume the particle has nonzero mass).
However, the story for the photon field is different, since the photon is massless.
A quick escape from the conundrum is to assume the photon has a small mass $m_\gamma$, and latter set $m_\gamma \rightarrow 0$.



\section{Cross Section and Decay Rates}

One important physical observable is the transition amplitude from initial state $|i;t_i\rangle$ and initial time $t_i$ to the finial state $|f;t_f\rangle$ at $t_f$.
In the scattering experiment, the initial and final states are assumed to be ``free''.
For this reason, we can think of the process as start from $t=-\infty$ to $t=+\infty$, where free states at $t=\pm \infty$ are known as \textit{asymptotic states}.
We give the time-evolution operator a special name: the \textit{S-matrix}, defined as:
\begin{equation}
	\langle f|S| i\rangle_{\text{Heisenberg}}
	= \langle f ; \infty \mid i ;-\infty\rangle.
\end{equation}
The S-matrix is related to quantities experimentally measurable, for example the cross sections or decay rates, as discussed in the following.

\subsubsection{Cross Sections}
The \textit{cross section} is an analogy from classical scattering experiment.
For example, Rutherford was interested in the size $r$ of an atomic nucleus. 
By colliding $\alpha$-particles with gold foil and measuring how many $\alpha$-particles were scattered, he could determine the cross-sectional area $\sigma=\pi r^{2}$ of the nucleus. 

Imagine there is just a single nucleus. 
Then the \textit{cross-sectional area} is given by
\begin{equation}
	\sigma=\frac{\text { number of particles scattered }}{\text { time } \times \text { number density in beam } \times \text { velocity of beam }}=\frac{1}{T} \frac{1}{\Phi} N,
\end{equation}
where $T$ is the time for the experiment and $\Phi$ is the incoming flux:
\begin{equation*}
	\Phi= \text{number density} \times \text{velocity of beam},
\end{equation*}
and $N$ is the number of particles scattered.

In quantum mechanical generalization of the notion of cross-sectional area is the cross section, which still has units of area, but has a more abstract meaning as a measure of the interaction strength. 
While classically an $\alpha$-particle either scatters off the nucleus or it does not scatter, quantum mechanically it has a probability for scattering. 
The classical differential probability is 
\begin{equation*}
	P=\frac{N}{N_{\text{inc}}},
\end{equation*}
where $N$ is the number of particles scattering into a given area and $N_{\text {inc }}$ is the number of incident particles. 
So the quantum mechanical cross section is then naturally
\begin{equation}
	d \sigma=\frac{1}{T} \frac{1}{\Phi} d P,
\end{equation}
where $\Phi$ is the flux, now normalized as if the beam has just one particle, and $P$ is now the quantum mechanical probability of scattering. 
The differential quantities $d \sigma$ and $d P$ are differential in kinematical variables, such as the angles and energies of the final state particles. 
The differential number of scattering events measured in a collider experiment is
\begin{equation}
	d N=L \times d \sigma,
\end{equation}
where $L$ is the \textit{luminosity}, which is defined by this equation.

Now let us relate the formula for the differential cross section to S-matrix elements. 
From a practical point of view it is impossible to collide more than two particles at a time, thus we can focus on the special case of S-matrix elements where $|i\rangle$ is a two-particle state. 
So, we are interested in the differential cross section for the ($2 \rightarrow n$) process:
\begin{equation}
	p_{1}+p_{2} \rightarrow\left\{p_{j}\right\}.
\end{equation}
In the rest frame of one of the colliding particles, the flux is just the magnitude of the velocity of the incoming particle divided by the total volume: $\Phi=|\vec{v}| / V$. 
In a different frame, such as the center-of-mass frame, beams of particles come in from both sides, and the flux is then determined by the difference between the particles' velocities. 
So, $\Phi=$ $\left|\vec{v}_{1}-\vec{v}_{2}\right| / V$. 
This should be familiar from classical scattering. 
Thus,
\begin{equation}
	d \sigma=\frac{V}{T} \frac{1}{\left|\vec{v}_{1}-\vec{v}_{2}\right|} d P.
\end{equation}
From quantum mechanics we know that probabilities are given by the square of amplitudes. 
Since quantum field theory is just quantum mechanics with a lot of fields, the normalized differential probability is
\begin{equation}
	dP=\frac{|\langle f|S| i\rangle|^{2}}{\langle f | f\rangle\langle i | i\rangle} d \Pi.
\end{equation}
Here, $d \Pi$ is the region of final state momenta at which we are looking. 
It is proportional to the product of the differential momentum, $d^{3} p_{j}$, of each final state and must integrate to 1. 
So
\begin{equation}
	d \Pi=\prod_{j} \frac{V}{(2 \pi)^{3}} d^{3} p_{j}.
\end{equation}
This has $\int d \Pi=1$, since $\int \frac{d p}{2 \pi}=\frac{1}{L}$ (by dimensional analysis and our $2 \pi$ convention).
According to our normalization convention for single-particle state,
\begin{equation}
	\langle p|p\rangle = (2\omega_p)(2\pi)^3\delta^{(3)}(0) = 2\omega_p V.
\end{equation}
Now let us turn to the S-matrix element $\langle f|S| i\rangle$. 
We usually calculate S-matrix elements perturbatively. 
In a free theory, where there are no interactions, the S-matrix is simply the identity matrix. 
We can therefore write
\begin{equation}
	S=1+i \mathcal{T},
\end{equation}
where $\mathcal{T}$ is called the transfer matrix and describes deviations from the free theory. 
Since the S-matrix should vanish unless the initial and final states have the same total 4-momentum, it is helpful to factor an overall momentum-conserving $\delta$-function:
\begin{equation}
	\mathcal{T}=(2 \pi)^{4} \delta^{4}(\Sigma p) \mathcal{M}
\end{equation}
Here, $\delta^{4}(\Sigma p)$ is shorthand for $\delta^{4}\left(\Sigma p_{i}-\Sigma p_{f}\right)$, where $p_{i}$ are the initial particles' momenta and $p_{f}$ are the final particles' momenta. 
In this way, we can focus on computing the nontrivial part of the S-matrix, $\mathcal{M}$. 
In quantum field theory, ``matrix elements'' usually means $\langle f|\mathcal{M}| i\rangle$. Thus we have
\begin{equation}
	\langle f|\mathcal T| i\rangle=(2 \pi)^{4} \delta^{4}(\Sigma p)\langle f|\mathcal{M}| i\rangle.
\end{equation}
So,
\begin{equation}
\begin{aligned}
	d P &=\frac{\delta^{4}(\Sigma p) T V(2 \pi)^{4}}{\left(2 E_{1} V\right)\left(2 E_{2} V\right)} \frac{|\mathcal{M}|^{2}}{\prod_{j}\left(2 E_{j} V\right)} \prod_{j} \frac{V}{(2 \pi)^{3}} d^{3} p_{j} \\
	&=\frac{T}{V} \frac{1}{\left(2 E_{1}\right)\left(2 E_{2}\right)}|\mathcal{M}|^{2} d \Pi_{\mathrm{LIPS}}
\end{aligned}
\end{equation}
where
\begin{equation}
	d \Pi_{\text {LIPS }} \equiv \prod_{\text {final states } j} \frac{d^{3} p_{j}}{(2 \pi)^{3}} \frac{1}{2 E_{p_{j}}}(2 \pi)^{4} \delta^{4}(\Sigma p)
\end{equation}
is called the \textit{Lorentz-invariant phase space} (LIPS).
Putting everything together, we have
\begin{equation}
	d \sigma=\frac{1}{\left(2 E_{1}\right)\left(2 E_{2}\right)\left|\vec{v}_{1}-\vec{v}_{2}\right|}|\mathcal{M}|^{2} d \Pi_{\text {LIPS }}
\end{equation}
All the factors of $V$ and $T$ have dropped out, so now it is trivial to take $V \rightarrow \infty$ and $T \rightarrow \infty$. Recall also that velocity is related to momentum by $\vec{v}=\vec{p} / p_{0}$.


\subsubsection{Decay Rates}
An unstable particle may decays to other particle(s), the rate of which is called the \textit{decay rate}.
A \textit{differential decay rate} is the probability that a one-particle state with momentum $p_{1}$ turns into a multi-particle state with momenta $\left\{p_{j}\right\}$ over a time $T$:
\begin{equation}
	d \Gamma=\frac{1}{T} d P .
\end{equation}
Of course, it is impossible for the incoming particle to be an asymptotic state at $-\infty$ if it is to decay, and so we should not be able to use the $S$-matrix to describe decays. 
The reason this is not a problem is that we calculate the decay rate in perturbation theory assuming the interactions happen only over a finite time $T$. 
Thus, a decay is really just like a ($1 \rightarrow n$) scattering process.

Following the same steps as for the differential cross section, the decay rate can be written as
\begin{equation}
	d \Gamma=\frac{1}{2 E_{1}}|\mathcal{M}|^{2} d \Pi_{\text {LIPS }}
\end{equation}
Note that this is the decay rate in the rest frame of the particle. 
If the particle is moving at relativistic velocities, it will decay much slower due to time dilation. 
The rate in the boosted frame can be calculated from the rest-frame decay rate using special relativity.





\section{LSZ Reduction Formula}

The LSZ reduction formula is used to simplify the calculation of the S-matrix in the momentum space.
It essentially states that for the S-matrix of an ($n \rightarrow m$) process, the matrix element equals to the \textit{amputated Green's function}, which is the Green's function with in and out states propagators amputated:
\begin{equation}
	\tilde{G}(k_1,\cdots,k_n) = \left[\prod_{i=1}^n \tilde{G}(k_i) \right] \tilde{G}_{\mathrm{amp}}(k_1,\cdots,k_n).
\end{equation}
Or, in the coordinate space (for scalar field), 
\begin{equation}
	\tilde{G}_{\mathrm{amp}}(k_1,\cdots,k_n) = \left[\prod_{i=1}^n \int d x_i e^{-i k_i x_i} \frac{-\partial^2-m^2}{i\sqrt Z} \right] G(x_1,\cdots,x_n).
\end{equation}
Note that since the in and out states are on-shell, the factor $-\partial^2-m^2$ effectively filter out the singularity $\frac{i}{k^2-m^2}$, and any regular term without singularity will not affect the result.

\subsection{Asymptotic Process}
To get the basis idea how it happens, consider the correlation function
\begin{equation}
	iG(y_m,\cdots,y_1,x_1,\cdots,x_n) = \langle\Omega|\phi(y_m)\cdots\phi(y_1) \phi(x_1)\cdots\phi(x_n)|\Omega\rangle.
\end{equation}
Now we are going to Fourier transform this function for the variable $x_1$.
First we split the time to three domains: $(-\infty,T_-]$, $(T_-,T_+)$, and $[T_+,+\infty)$ such that at time $T_{\pm}$ the particles are well-separated.
Consider first the integral over the first domain:
\begin{equation}
	\int_{-\infty}^{T_-} dx_1^0 \int d^3 x\ e^{i k\cdot x_1} \int \frac{d^3q}{(2\pi)^3}\frac{1}{2\omega_q}\langle \Omega|\phi(y_m)\cdots\phi(y_1) \phi(x_2)\cdots\phi(x_n)|q\rangle \langle q|\phi(x_1) |\Omega\rangle,
\end{equation}
where we have inserted the complete set of intermediate states.\footnote{Note that the multi-particle state are discarded as discussed. Also, the single particle state $|k\rangle$ shall be think as a concentrated wave packet near the particle at $\bm x_1$, so that it has negligible overlap with other particle states.}
Then use the fact $\langle q|\phi(x_1)|\Omega\rangle = \sqrt{Z_\phi} e^{i q \cdot x_1}$, 
\begin{equation}
	\int_{-\infty}^{T_-} dx_1^0 \ e^{i (k^0+\omega_q-i\epsilon)\cdot x_1^0}\frac{\sqrt{Z_\phi}}{2\omega_k}\langle \Omega|\phi(y_m)\cdots\phi(y_1) \phi(x_2)\cdots\phi(x_n)|k\rangle,
\end{equation}
The time integral gives the singularity at $k^0=-\omega_k$:
\begin{equation}
	\frac{1}{2\omega_k} \frac{i}{\omega_k+k^0 + i\epsilon} = \frac{i\sqrt{Z_\phi}}{k^2-m^2+i\epsilon} + \text{regular terms}.
\end{equation}

Now consider the integral over the third time domain.
The calculation is basically the same, the difference is the insertion gives
\begin{equation*}
	\langle\Omega| \phi(x_1) |q\rangle = \sqrt{Z_\phi} e^{i q \cdot x_1},
\end{equation*}
which leads to a singularity at $k^0=\omega_k$:
\begin{equation}
	\frac{1}{2\omega_k} \frac{i}{\omega_k-k^0 + i\epsilon} = \frac{i\sqrt{Z_\phi}}{k^2-m^2+i\epsilon} + \text{regular terms}.
\end{equation}
Note that although for the above two cases, the final singular expression can be brought to the same form, the location of the singularity is different, which indicate whether it is the in or out state.
Specific frequency filter can be chosen to select out the component accordingly.

Finally, consider the integral over time interval $(T_-,T_+)$, where the particle are interacting and single particles are not well defined.
On this interval the correlation will not have any singularity.\footnote{some branch cuts are possible, but they will also be annihilated by $k^2-m^2$ term.}
We then know that if we choose $\phi(x_1)$ to create the in state, and we only care about the singular structure, then the Fourier transformation produce the factor
\begin{equation}
	\frac{i\sqrt{Z_\phi}}{k_1^2-m_1^2}.
\end{equation}
The same procedure applies to every field operator, and the final result is
\begin{equation}
\begin{aligned}
	S &= \langle p_1,\cdots,p_1;T_+|k_1,\cdots,k_n;T_-\rangle \\
	&= i\tilde{G}_{\mathrm{amp}}(p_m,\cdots,p_1;-k_1,\cdots,-k_n) \delta^{(4)}\left(\sum p-\sum k \right).
\end{aligned}
\end{equation}
Or, the matrix element satisfies
\begin{equation}
	\mathcal M_{fi} = \tilde{G}_{\mathrm{amp}}(p_m,\cdots,p_1;-k_1,\cdots,-k_n).
\end{equation}


\subsection{Operator Proof for Scalar Field}
Here we choose another way to prove the LSZ formula.
We think a single-particle state to be created by the particle creation operator $a^\dagger$.
For free theory, we have
\begin{equation}
\begin{aligned}
	\sqrt{2\omega_k} a_k &= i \int d^3 x\ e^{ik\cdot x}(-i\omega_k+\partial_t)\phi(x), \\
	\sqrt{2\omega_k} a^\dagger_k &= -i \int d^3 x\ e^{-ik\cdot x}(i\omega_k+\partial_t)\phi(x).
\end{aligned}
\end{equation}
When interaction is turned on, the field operator $\phi(x)$ is renormalized as
\begin{equation*}
	\phi_R(x) \sim \sqrt{Z_{\phi}} \phi_{\mathrm{in}}(x) \sim \sqrt{Z_{\phi}} \phi_{\mathrm{out}}(x),
\end{equation*}
so we define the particle creation operator as
\begin{equation}
	a_R^\dagger \equiv -i \int d^3 x\ e^{-ik\cdot x}(i\omega_k+\partial_t)\phi_R(x).
\end{equation}
When acting on the vacuum:
\begin{equation}
	\sqrt{2\omega_k} a_R^\dagger(k) |\Omega\rangle = |k\rangle + \text{multi-particle states}.
\end{equation}
On may wonder why $a_{\mathrm{in}}(k)$ do not contribute to the single-particle state. 
To see that, one can think of the original particle-creation operator $a^\dagger(k)$ in the frequency domain to have a delta function peak at $\omega_k$.
While for the $a(k)$ in the interacting theory, although it can have weight at the frequency $\omega_k$, there will be no delta-function-like peak.

The in and out state are though to be created by the operator $a_R^\dagger(k)$.
Note that as discussed, the multi-particle contribution is discarded.
In the Heisenberg picture, the particle-creation operator satisfies:
\begin{equation}
\begin{aligned}
	a_{R}^\dagger(-\infty) - a_{R}^\dagger(+\infty)
	&= \frac{i}{\sqrt{2\omega_k}} \int dt\ \partial_t \left[\int d^{3}x\ e^{-ikx}(i\omega_k+\partial_t)\phi_R(x)\right] \\
	&= \frac{i}{\sqrt{2\omega_k}} \int d^4 x e^{-ik\cdot x}(\omega_k^2+\partial_t^2)\phi_R(x) \\
	&= \frac{i}{\sqrt{2\omega_k}} \int d^4 x e^{-ik\cdot x}\partial_t^2\phi_0(x) + \phi_R(x)(-\nabla^2+m^2)e^{-i k\cdot x} \\
	&= \frac{i}{\sqrt{2\omega_k}} \int d^4 x e^{-ik\cdot x}(\partial^2+m^2)\phi_R(x)
\end{aligned}
\end{equation}
The initial and final states are:
\begin{equation}
\begin{aligned}
	|k_1, \cdots, k_m; \mathrm{in}\rangle &= \left[\prod_{j=1}^m \sqrt{2\omega_{k_j}} a^\dagger_{R}(k_j;-\infty)\right] |\Omega\rangle, \\
	|p_1, \cdots, p_n, \mathrm{out}\rangle &= \left[\prod_{j=1}^n \sqrt{2\omega_{p_j}}a^\dagger_{R}(p_j;+\infty)\right] |\Omega\rangle.
\end{aligned}
\end{equation}
The S-matrix is
\begin{equation*}
\begin{aligned}
	S_{fi} &= \langle p_1, \cdots, p_n;\mathrm{out}| S |k_1, \cdots, k_m; \mathrm{in}\rangle \\
	&= \frac{\langle 0|T 
		\left(\prod \sqrt{2\omega_{p_j}} a_{p_j;\mathrm{out}} \right)
		\int d^4 x \exp(i\mathcal{L}_{\mathrm{int}})
		\left(\prod \sqrt{2\omega_{k_j}} a^\dagger_{k_j;\mathrm{in}} \right)|0\rangle}
		{\langle 0|T\int d^4 x \exp(i\mathcal{L}_{\mathrm{int}})|0\rangle}
\end{aligned}
\end{equation*}
Since the scattering process correspond to the connected diagram, meaning that the initial and final state has distinct momentum particles.
We are free to make the substitution
\begin{equation*}
	a^\dagger_{\mathrm{in}} \rightarrow (a_{\mathrm{in}}^\dagger - a_{\mathrm{out}}^\dagger),\ 
	a_{\mathrm{out}} \rightarrow -(a_{\mathrm{in}}^\dagger - a_{\mathrm{out}}^\dagger)^\dagger.
\end{equation*}
In this way, the S-matrix is
\begin{equation}
\begin{aligned}
	& \langle p_1, \cdots, p_n| S |k_1, \cdots, k_m\rangle  \\
	=& \prod_{i=1}^{m}\left[ \int d^dx_i \ e^{ip_i\cdot x_i}i(\partial^2+m_i^2)\right]
	\prod_{j=m+1}^{m+n}\left[\int d^dx_j \ e^{-ik_j\cdot x_j}i(\partial^2+m_j^2)\right] iG(\{x\}).
	\label{eq:K-G-LSZ}
\end{aligned}
\end{equation}
In momentum space
\begin{equation}
	\mathcal M = \prod_{i=1}^{m}\left[\frac{p_i^2-m_i^2}{i\sqrt{Z_\phi}}\right]
		\prod_{j=m+1}^{m+n}\left[\frac{k_j^2-m_j^2}{i\sqrt{Z_\phi}}\right]
		\tilde{G}(\{p_i\};\{-k_j\}).
\end{equation}
We thus proved the LSZ reduction formula again.

Note that in the second equality, we move the operator $\partial^2$ out of the time-ordering operator, which will actually create \textit{contact terms}.
We will show the contact term can be safely neglected.
To see this, first consider the time-ordered two-point function:
\begin{equation}
	\langle 0|T\phi(x_1)\phi(x_2)|0\rangle
	= \theta(t_1-t_2)\langle 0|\phi(x_1)\phi(x_2)|0\rangle -
	\theta(t_2-t_1)\langle 0|\phi(x_2)\phi(x_1)|0\rangle.
\end{equation}	
Take time derivative on both side:
\begin{equation*}
\begin{aligned}
	\partial_{t_1} \langle 0|T\phi(x_1)\phi(x_2)|0\rangle
	&= \langle 0|T\partial_{t_1}\phi(x_1)\phi(x_2)|0\rangle +
	\delta(t_1-t_2)\langle 0|[\phi(x_1),\phi(x_2)]|0\rangle \\
	&= \langle 0|T\partial_{t_1}\phi(x_1)\phi(x_2)|0\rangle.
\end{aligned}
\end{equation*}
The second equality follows from the fact that $x_1,x_2$ is equal-time.
Take the the time derivative once more:
\begin{equation*}
	\partial^2_{t_1} \langle 0|T\phi(x_1)\phi(x_2)|0\rangle
	= \langle 0|T\partial^2_{t_1}\phi(x_1)\phi(x_2)|0\rangle +
	\delta(t_1-t_2)\langle 0|[\partial_{t_1}\phi(x_1),\phi(x_2)]|0\rangle.
\end{equation*}
The second term on the right hand side is the contact term.
For free theory, $\partial_{t_1}\phi(x_1)$ is the canonical momentum, meaning that
\begin{equation}
	[\phi(\vec x_1, t),\partial_{t}\phi(\vec x_1,t)] = i \delta^{3}(\vec x_1-\vec x_2).
\end{equation}
In general, for $n$-point correlation,
\begin{equation}
\begin{aligned}
	 \partial_{t_1}^2 \langle T\phi_{x_1}\cdots\phi_{x_n} \rangle
	= \langle T\partial_{t_1}^2\phi_{x_1}\cdots\phi_{x_n}\rangle -i \sum_j \delta^4(x_1-x_j)\langle T\phi_{x_2}\cdots\cancel{\phi_{x_j}}\cdots\phi_{x_n}\rangle.
\end{aligned}
\end{equation}
In the LSZ formula, the contact term do not have any singularity.
When the external legs approach to momentum shell, these regular terms vanishes, so the contact will not contribute to the S-matrix.







\subsection{LSZ for Dirac Field}
Use the field expansion
\begin{equation}
\begin{aligned}
	\psi(x) &=\int \frac{d^{3} p}{(2 \pi)^{3}} \frac{1}{\sqrt{2 \omega_{\mathbf{p}}}} 
		\sum_{s}\left(a_{\mathbf{p}}^{s} u^{s}(p) e^{-i p \cdot x}
		+b_{\mathbf{p}}^{s \dagger} v^{s}(p) e^{i p \cdot x}\right), \\
	\bar{\psi}(x) &=\int \frac{d^{3} p}{(2 \pi)^{3}} \frac{1}{\sqrt{2 \omega_{\mathbf{p}}}} 
		\sum_{s}\left(b_{\mathbf{p}}^{s} \bar{v}^{s}(p) e^{-i p \cdot x}
		+a_{\mathbf{p}}^{s \dagger} \bar{u}^{s}(p) e^{i p \cdot x}\right),
\end{aligned}
\end{equation}
and the orthogonality relation
\begin{equation}
\begin{aligned}
	u^{r \dagger}(p) u^{s}(p) &= 2 \omega_{\bm p} \delta^{r s}, & 
	u^{r \dagger}(\bm p,\omega_{\bm p}) v^{s}(-\bm p,\omega_{\bm p}) &= 0,\\
	v^{r \dagger}(p) v^{s}(p) &= 2\omega_{\bm p} \delta^{r s}, & 
	v^{r \dagger}(\bm p,\omega_{\bm p}) u^{s}(-\bm p,\omega_{\bm p}) &= 0.
\end{aligned}
\end{equation}
The spatial Fourier transformation gives:
\begin{equation}
	\int d^3x e^{ip\cdot x}\psi(x) = \frac{1}{\sqrt{2\omega_{\bm p}}}\sum_s a^s_{\bm p}u^s(p) +\frac{1}{\sqrt{2\omega_{\bm p}}}\sum_s b^{s \dagger}_{\bm p} v^s(-\bm p,\omega) e^{2i\omega t}
\end{equation}
Left-multiply on both hand side by $\bar u^{s}(p) \gamma^0$, we then get
\begin{equation}
\begin{aligned}
	\sqrt{2\omega_{\bm p}}a^{s}_{\bm p} &= \int d^3 x e^{ip\cdot x}\bar u^{s}(p)\gamma^0 \psi(x), \\
	\sqrt{2\omega_{\bm p}}a^{s \dagger}_{\bm p} &= \int d^3 x e^{-ip\cdot x}\bar\psi(x)\gamma^0 u^{s}(p).
\end{aligned}
\end{equation}
Similarly, we consider
\begin{equation}
	\int d^3x e^{ip\cdot x}\bar\psi(x) = \frac{1}{\sqrt{2\omega_{\bm p}}}\sum_s b^s_{\bm p}\bar v^s(p) +\frac{1}{\sqrt{2\omega_{\bm p}}}\sum_s a^{s \dagger}_{\bm p} \bar u^s(-\bm p,\omega) e^{2i\omega t}
\end{equation}
Right-multiply on both hand side by $\gamma^0 v^{s}(p)$, we then get
\begin{equation}
\begin{aligned}
	\sqrt{2\omega_{\bm p}}b^{s}_{\bm p} &= \int d^3 x e^{ip\cdot x}\bar\psi(x)\gamma^0 v^s(p), \\
	\sqrt{2\omega_{\bm p}}b^{s \dagger}_{\bm p} &= \int d^3 x e^{-ip\cdot x}\bar v^s(p)\gamma^0 \psi(x).
\end{aligned}
\end{equation}
Following the same strategy as we did for the scalar field, we consider
\begin{equation}
\begin{aligned}
	\sqrt{2\omega_{\bm p}}a^{s}_{\bm p;\mathrm{out}} - 
	\sqrt{2\omega_{\bm p}}a^{s}_{\bm p;\mathrm{in}} 
	&= \int dt\ \partial_t \sqrt{2\omega_{\bm p}}a^s_{\bm p} \\
	&= \int dt\ \int d^3x e^{ip\cdot x}\bar u(p)(\gamma^0 \partial_t +i\gamma^0 p^0)\psi(x) \\
	&= \int d^4x e^{ip\cdot x}\bar u(p)(\gamma^0 \partial_t +i\gamma^i p^i +i m)\psi(x) \\ 
	&= i\int d^4x e^{ip\cdot x}\bar u(p)(-i\cancel\partial + m)\psi(x)
\end{aligned}
\end{equation}
where we have used the fact $\bar u(p) (\cancel p - m) = 0$.
Take hermitian conjugate,
\begin{equation}
\begin{aligned}
	\sqrt{2\omega_{\bm p}}a^{s \dagger}_{\bm p;\mathrm{in}} - 
	\sqrt{2\omega_{\bm p}}a^{s \dagger}_{\bm p;\mathrm{out}} 
	&= i\int d^4x e^{-ip\cdot x}\bar\psi(x)\gamma^0(-i\cancel\partial + m)^\dagger \gamma^0 u(p) \\
	&= i\int d^4x e^{-ip\cdot x}\bar\psi(x)(i \overleftarrow{\cancel\partial} + m) u(p)
\end{aligned}
\end{equation}
Similarly, using the fact $(\cancel p + m)v(p) =0$,
\begin{equation}
\begin{aligned}
	\sqrt{2\omega_{\bm p}}b^{s}_{\bm p;\mathrm{out}} - 
	\sqrt{2\omega_{\bm p}}b^{s}_{\bm p;\mathrm{in}} 
	&= \int d^4x e^{ip\cdot x}\bar\psi(x)(\gamma^0 \overleftarrow{\partial_t} +i\gamma^0 p^0)v(p) \\
	&= \int d^4x e^{ip\cdot x}\bar\psi(x)(\gamma^0 \overleftarrow{\partial_t} +i\gamma^i p^i -i m)v(p) \\ 
	&= -i\int d^4x e^{ip\cdot x}\bar\psi(x)(i\overleftarrow{\cancel\partial} + m)v(p).
\end{aligned}
\end{equation}
Again, take the hermitian conjugate,
\begin{equation}
\begin{aligned}
	\sqrt{2\omega_{\bm p}}b^{s \dagger}_{\bm p;\mathrm{in}} - 
	\sqrt{2\omega_{\bm p}}b^{s \dagger}_{\bm p;\mathrm{out}} 
	&= -i\int d^4x e^{ip\cdot x}\bar v(p)\gamma^0(i\overleftarrow{\cancel\partial} + m)^\dagger \gamma^0 \psi(x) \\
	&= -i\int d^4x e^{-ip\cdot x}\bar v(p)(-i \cancel\partial + m) \psi(x)
\end{aligned}
\end{equation}
The same strategy gives the LSZ reduction formula for Dirac field.
Consider the S-matrix for particles:
\begin{equation}
\begin{aligned}
	& \langle p_1, \cdots, p_n| S |k_1, \cdots, k_m\rangle  \\
	=& \prod_{i=1}^{m}\left[ \int d^dx_i \ e^{ip_i\cdot x_i} u^{s_1}(p_i)\frac{i\cancel\partial-m_i}{i\sqrt{Z_\phi}}\right] iG(\{x\})
	\prod_{j=m+1}^{m+n}\left[\int d^dx_j \ e^{-ik_j\cdot x_j}\frac{-i\overleftarrow{\cancel\partial}-m_j}{i\sqrt{Z_\phi}}u^{s_j}(k_j)\right].
\end{aligned}
\end{equation}
In the momentum space:
\begin{equation}
	\mathcal M = \prod_{i=1}^{m}\left[\frac{\cancel p-m_i}{i\sqrt{Z_\phi}}u^{s_i}(p_i)\right]
		\tilde{G}(\{p_i\};\{-k_j\})
		\prod_{j=m+1}^{m+n}\left[u^{s_j}(k_j)\frac{\cancel k-m_j}{i\sqrt{Z_\phi}}\right].
\end{equation}




